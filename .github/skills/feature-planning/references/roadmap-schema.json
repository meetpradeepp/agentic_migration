{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Product Roadmap Schema",
  "description": "Schema for product roadmap generated by feature-planning skill",
  "type": "object",
  "required": [
    "id",
    "project_name",
    "version",
    "vision",
    "target_audience",
    "phases",
    "features",
    "metadata"
  ],
  "properties": {
    "id": {
      "type": "string",
      "description": "Unique identifier for this roadmap",
      "pattern": "^roadmap-[0-9]+$",
      "examples": ["roadmap-1234567890"]
    },
    "project_name": {
      "type": "string",
      "description": "Name of the project",
      "minLength": 1,
      "examples": ["TaskFlow", "DevTools CLI"]
    },
    "version": {
      "type": "string",
      "description": "Roadmap version",
      "pattern": "^[0-9]+\\.[0-9]+(\\.[0-9]+)?$",
      "examples": ["1.0", "1.0.0"]
    },
    "vision": {
      "type": "string",
      "description": "Product vision one-liner from discovery",
      "minLength": 10,
      "maxLength": 200,
      "examples": [
        "The simplest way for small teams to manage projects without complexity"
      ]
    },
    "target_audience": {
      "type": "object",
      "required": ["primary"],
      "properties": {
        "primary": {
          "type": "string",
          "description": "Primary persona/audience",
          "examples": ["Small team leads (3-10 people)"]
        },
        "secondary": {
          "type": "array",
          "description": "Secondary personas",
          "items": {
            "type": "string"
          },
          "examples": [["Individual contributors", "Project managers"]]
        }
      }
    },
    "phases": {
      "type": "array",
      "description": "Execution phases organizing features",
      "minItems": 1,
      "items": {
        "$ref": "#/definitions/phase"
      }
    },
    "features": {
      "type": "array",
      "description": "All features across all phases",
      "minItems": 3,
      "items": {
        "$ref": "#/definitions/feature"
      }
    },
    "metadata": {
      "type": "object",
      "required": [
        "created_at",
        "updated_at",
        "generated_by",
        "prioritization_framework"
      ],
      "properties": {
        "created_at": {
          "type": "string",
          "format": "date-time",
          "description": "ISO 8601 timestamp of creation"
        },
        "updated_at": {
          "type": "string",
          "format": "date-time",
          "description": "ISO 8601 timestamp of last update"
        },
        "generated_by": {
          "type": "string",
          "description": "Agent or tool that generated this roadmap",
          "examples": ["roadmap_features agent"]
        },
        "prioritization_framework": {
          "type": "string",
          "description": "Framework used for prioritization",
          "enum": ["MoSCoW", "RICE", "Kano", "Custom"],
          "examples": ["MoSCoW"]
        },
        "competitor_analysis_used": {
          "type": "boolean",
          "description": "Whether competitor analysis informed this roadmap",
          "default": false
        }
      }
    }
  },
  "definitions": {
    "phase": {
      "type": "object",
      "required": ["id", "name", "description", "order", "status", "features", "milestones"],
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique phase identifier",
          "pattern": "^phase-[0-9]+$",
          "examples": ["phase-1", "phase-2"]
        },
        "name": {
          "type": "string",
          "description": "Phase name",
          "enum": ["Foundation", "Enhancement", "Scale", "Future", "MVP", "Growth"],
          "examples": ["Foundation", "Enhancement"]
        },
        "description": {
          "type": "string",
          "description": "What this phase achieves",
          "minLength": 10,
          "examples": ["Establish core functionality and MVP"]
        },
        "order": {
          "type": "integer",
          "description": "Execution order (1-indexed)",
          "minimum": 1,
          "examples": [1, 2, 3]
        },
        "status": {
          "type": "string",
          "description": "Phase status",
          "enum": ["planned", "in-progress", "completed", "deferred"],
          "examples": ["planned"]
        },
        "features": {
          "type": "array",
          "description": "Feature IDs in this phase",
          "items": {
            "type": "string",
            "pattern": "^feature-[0-9]+$"
          },
          "examples": [["feature-1", "feature-2"]]
        },
        "milestones": {
          "type": "array",
          "description": "Key milestones for this phase",
          "items": {
            "$ref": "#/definitions/milestone"
          }
        }
      }
    },
    "milestone": {
      "type": "object",
      "required": ["id", "title", "description", "features", "status"],
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique milestone identifier",
          "pattern": "^milestone-[0-9]+-[0-9]+$",
          "examples": ["milestone-1-1", "milestone-2-1"]
        },
        "title": {
          "type": "string",
          "description": "Milestone name",
          "minLength": 5,
          "examples": ["Users can create and save tasks"]
        },
        "description": {
          "type": "string",
          "description": "What this milestone represents",
          "minLength": 10,
          "examples": [
            "Core task management workflow is functional and tested"
          ]
        },
        "features": {
          "type": "array",
          "description": "Feature IDs in this milestone",
          "items": {
            "type": "string",
            "pattern": "^feature-[0-9]+$"
          },
          "minItems": 1
        },
        "status": {
          "type": "string",
          "description": "Milestone status",
          "enum": ["planned", "in-progress", "completed"],
          "examples": ["planned"]
        }
      }
    },
    "feature": {
      "type": "object",
      "required": [
        "id",
        "title",
        "description",
        "rationale",
        "priority",
        "complexity",
        "impact",
        "phase_id",
        "dependencies",
        "status",
        "acceptance_criteria",
        "user_stories"
      ],
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique feature identifier",
          "pattern": "^feature-[0-9]+$",
          "examples": ["feature-1", "feature-42"]
        },
        "title": {
          "type": "string",
          "description": "Feature name (action-oriented)",
          "minLength": 5,
          "maxLength": 100,
          "examples": [
            "Simple Task Creation",
            "One-Command Deployment"
          ]
        },
        "description": {
          "type": "string",
          "description": "What this feature does (2-3 sentences)",
          "minLength": 20,
          "examples": [
            "Allow users to create tasks with a single click, requiring only title and assignee. Task appears immediately in the board view."
          ]
        },
        "rationale": {
          "type": "string",
          "description": "Why this feature matters for target audience",
          "minLength": 20,
          "examples": [
            "Addresses core pain point of complexity - users need to create tasks quickly during meetings without training or delay"
          ]
        },
        "priority": {
          "type": "string",
          "description": "MoSCoW priority",
          "enum": ["must", "should", "could", "wont"],
          "examples": ["must", "should"]
        },
        "complexity": {
          "type": "string",
          "description": "Implementation complexity",
          "enum": ["low", "medium", "high"],
          "examples": ["low", "medium"]
        },
        "impact": {
          "type": "string",
          "description": "User/business impact",
          "enum": ["low", "medium", "high"],
          "examples": ["high"]
        },
        "phase_id": {
          "type": "string",
          "description": "Phase this feature belongs to",
          "pattern": "^phase-[0-9]+$",
          "examples": ["phase-1"]
        },
        "dependencies": {
          "type": "array",
          "description": "Feature IDs this feature depends on",
          "items": {
            "type": "string",
            "pattern": "^feature-[0-9]+$"
          },
          "examples": [["feature-1", "feature-2"], []]
        },
        "status": {
          "type": "string",
          "description": "Feature status",
          "enum": ["idea", "planned", "in-progress", "completed", "deferred"],
          "examples": ["idea", "planned"]
        },
        "acceptance_criteria": {
          "type": "array",
          "description": "Testable criteria for feature completion",
          "items": {
            "type": "string"
          },
          "minItems": 1,
          "examples": [
            [
              "User can create task in < 10 seconds",
              "Only 2 required fields: title and assignee",
              "Task appears immediately in board view"
            ]
          ]
        },
        "user_stories": {
          "type": "array",
          "description": "User stories in format 'As a [user], I want [action] so that [benefit]'",
          "items": {
            "type": "string",
            "pattern": "^As a .+, I want .+ so that .+$"
          },
          "minItems": 1,
          "examples": [
            [
              "As a team lead, I want to quickly capture action items during meetings so that nothing gets forgotten"
            ]
          ]
        },
        "competitor_insight_ids": {
          "type": "array",
          "description": "IDs of competitor pain points this feature addresses",
          "items": {
            "type": "string"
          },
          "examples": [["pain-point-1", "pain-point-2"], []]
        }
      }
    }
  }
}
